{% load static %}
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ã‚´ãƒ«ãƒ•ã‚³ãƒ³ãƒšå‚åŠ è€…ä¸€è¦§</title>
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>
<body>
    <h1>ã‚´ãƒ«ãƒ•ã‚³ãƒ³ãƒšå‚åŠ è€…ä¸€è¦§</h1>

    <!-- å…¨é¸æŠãƒ»é¸æŠè§£é™¤ãƒœã‚¿ãƒ³ã®è¿½åŠ  -->
    <div>
        <button type="button" id="selectAll">ã™ã¹ã¦é¸æŠ</button>
        <button type="button" id="deselectAll">é¸æŠã‚’è§£é™¤</button>
        <a href="{% url 'participant_register' %}" class="btn btn-primary">å‚åŠ è€…ã®æ–°è¦ç™»éŒ²</a>
        <a href="{% url 'show_delete_participants_form' %}" class="btn btn-primary">å‚åŠ è€…ã®å‰Šé™¤</a>
        <a href="{% url 'result_list' %}" class="btn">çµ„åˆ†ã‘çµæœã®ä¸€è¦§ã‚’è¦‹ã‚‹</a>
    </div>
    <div id="selectedCount">é¸æŠã•ã‚ŒãŸå‚åŠ è€…ã®äººæ•°: 0</div>
    <div>ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ãƒ¡ãƒ³ãƒãƒ¼ã®äººæ•°: {{ participant_count }}</div>

    <form action="{% url 'index' %}" method="post">
        {% csrf_token %}
        <table class="participant-list">
            <thead>
                <tr>
                    <th></th> <!-- ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ç”¨ã®ãƒ˜ãƒƒãƒ€ãƒ¼ -->
                    <th>åå‰</th>
                    <th>æ€§åˆ¥</th>
                    <th>å¹³å‡ã‚¹ã‚³ã‚¢</th>
                    <th>ã‚¯ãƒ«ãƒ</th>

                </tr>
            </thead>
            <tbody>
                {% for participant in participants %}
                <tr>
                    <td><input type="checkbox" name="participants[]" value="{{ participant.id }}"></td>
                    <!-- åå‰ã‚’ã‚¯ãƒªãƒƒã‚¯å¯èƒ½ã«ã—ã€ã‚¯ãƒªãƒƒã‚¯ã—ãŸã‚‰ç·¨é›†ãƒšãƒ¼ã‚¸ã¸é·ç§»ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ -->
                    <td><a href="{% url 'participant_edit' participant.id %}" style="color: inherit; text-decoration: none;">{{ participant.name }}</a>{% if participant.is_etiquette_leader %}â›³ï¸{% endif %}</td>
                    <td>{% if participant.gender == 'M' %}ç”·æ€§{% elif participant.gender == 'F' %}å¥³æ€§{% else %}ãã®ä»–{% endif %}</td>
                    <td>{{ participant.average_score }}</td>
                    <td>
                        {% if participant.transportation == 'Y' %}
                            <span style="font-size: 24px;">ğŸš—</span>
                        {% endif %}
                    </td>
                    <td>
                        <!-- ç·¨é›†ãƒœã‚¿ãƒ³ã‚’å‰Šé™¤ -->
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <button type="submit" class="btn btn-primary">ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ã‘å®Ÿè¡Œ</button>
    </form>
    {% if messages %}
    <ul class="messages">
        {% for message in messages %}
        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
    </ul>
    {% endif %}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const updateSelectedCount = () => {
                const selectedCount = document.querySelectorAll('input[type="checkbox"][name="participants[]"]:checked').length;
                document.getElementById('selectedCount').textContent = `é¸æŠã•ã‚ŒãŸå‚åŠ è€…ã®äººæ•°: ${selectedCount}`;
            };
        
            // ã™ã¹ã¦é¸æŠãƒ»é¸æŠè§£é™¤ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã«äººæ•°æ›´æ–°æ©Ÿèƒ½ã‚’è¿½åŠ 
            document.getElementById('selectAll').addEventListener('click', function() {
                document.querySelectorAll('input[type="checkbox"][name="participants[]"]').forEach(function(checkbox) {
                    checkbox.checked = true;
                });
                updateSelectedCount(); // äººæ•°ã‚’æ›´æ–°
            });
        
            document.getElementById('deselectAll').addEventListener('click', function() {
                document.querySelectorAll('input[type="checkbox"][name="participants[]"]').forEach(function(checkbox) {
                    checkbox.checked = false;
                });
                updateSelectedCount(); // äººæ•°ã‚’æ›´æ–°
            });
        
            // å„ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®çŠ¶æ…‹å¤‰æ›´æ™‚ã«äººæ•°ã‚’æ›´æ–°
            document.querySelectorAll('input[type="checkbox"][name="participants[]"]').forEach(function(checkbox) {
                checkbox.addEventListener('change', updateSelectedCount);
            });
        
            // åˆæœŸçŠ¶æ…‹ã§ã®äººæ•°æ›´æ–°
            updateSelectedCount();
        });
        </script>
</body>
</html>